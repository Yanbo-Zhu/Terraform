
# 1 `.terraform. lock.hcl`


The .terraform.lock.hcl file is not used to track module versions; ==it is used to lock the versions of the provider dependencies used by your Terraforrx configuration.==

At present, the dependency lock file tracks only provider dependencies. Terraform does not remember version selections for remote modules, and so Terraform will always select the newest available module version that meets the specified version constraints. You can use an exact version constraint to ensure that Terraform will always select the same module version.

---

When does Terraform create the .terraform.lock.hcl file?
A. After your first terraform plan
B. After your first terraform apply
C. After your first terraform init
D. Whenever you enable state locking
选C , Terraform automatically creates or updates the dependency lock file each time you run the terraform init command.


---


What does Terraform use .terraform.lock.hcl file for?
A. Tracking provider dependencies
B. There is no such file
C. Preventing Terraform runs from occurring
D. Storing references to workspaces which are locked


A. Tracking provider dependencies
The .terraform.lock.hcl file is used to track provider dependencies and their exact versions. This file is automatically generated by Terraform when you run terraform init. 
<u>It locks the versions of the providers used in your configuration, ensuring that subsequent Terraform runs use the same provider versions for consistency and reproducibility across environments. </u> This file should be committed to your version control system to maintain consistency across team members and environments.

"hcl , and this name is intended to signify that it is a lock file for various items that Terraform caches in the . terraform subdirectory of your working directory. Terraform automatically creates or updates the dependency lock file each time you run the terraform init command."

"Terraform has made some changes to the "provider dependency" selections recorded in the .terraform.lock.hcl file. Review those changes and commit them to your version control system if they represent changes you intended to make."



# 2 例子

## 2.1 例子1

You add a new resource to an existing Terraform configuration, but do not update the version constraint in the configuration. The existing and new resources use the same provider. The working directory contains a .terraform-lock.hcl file.
How will Terraform choose which version of the provider to use?
A. Terraform will use the latest version of the provider for the new resource and the version recorded in the lock file to manage existing
resources
B. Terraform will use the version recorded in your lock file
C. Terraform will check your state file to determine the provider version to use
D. Terraform will use the latest version of the provider available at the time you provision your new resource

选 B


## 2.2 例子2

If you update the version constraint in your Terraform configuration, Terraform will update your lock file the next time you run terraform init. -> False

Wrong. ==The command you used is to override the lock file's current version, installing the latest version, and the version tracked in the lock file will be ignored.==

You have to run terraform init -upgrade to change the version in .terraform.lock.hcl file.
Correct: "Use the -upgrade option if you want Terraform to ignore the dependency lock file and consider installing newer versions."

If a particular provider already has a selection recorded in the lock file, Terraform will always re-select that version for installation, even if a newer version has become available. You can override that behavior by adding the -upgrade option when you run terraform init, in which case Terraform will disregard the existing selections and once again select the newest available version matching the version constraint.


# 3 terraform.tfstate.d

Terraform stores the workspace states in a directory


## 3.1 init 后 provider plugins 插件安装到哪里去: .terraform/plugins 

A. The .terraform.plugins directory in the directory terraform init was executed in. 
B. The .terraform/plugins directory in the directory terraform init was executed in. 
C. /etc/terraform/plugins 
D. The .terraform.d directory in the directory terraform init was executed in.

选 B